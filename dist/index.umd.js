(function(_,y){typeof exports=="object"&&typeof module<"u"?y(exports):typeof define=="function"&&define.amd?define(["exports"],y):(_=typeof globalThis<"u"?globalThis:_||self,y(_.content_engine_lib={}))})(this,(function(_){"use strict";const y=()=>({set:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=Math.random()*16|0;return(e=="x"?r:r&3|8).toString(16)})}),u=async()=>({f:{name:e=>`${e.name}${e.id}`}});function g(e,r=1e3){let l={cnt:0};return new Promise(s=>{const t=()=>{console.log(`[setInterval] is running.. [count=${l.cnt}]`);try{e()&&(clearInterval(c),s())}catch{console.log(`warn: [wait_until] ignoring the exception in setInterval and will check again after [interval=${r}]`)}l.cnt+=1},c=setInterval(()=>{t()},r);t()})}console.log("content_engine_lib");let a={lib:{inbuilt_lib:[],l:{},set:async e=>{const r=e?.lib||[];for(const[l,s]of r.entries()){const t=s,c=`${t.name}:${e.run_from}`,o=`${e.run_from}_src`;let i=t[o];const d=`${e.run_from}_src`;let n=e?.lazy_lib?.[d]||null;if(n&&(n=n.replace("{*}",`${t.name}`)),console.log(`_lazy_src: ${n}`),console.log(`_src: ${i}`),a.lib.l.hasOwnProperty(`${c}`)==!1){if(/^[a-zA-Z0-9]/.test(i)&&i.includes("/")==!1&&a.lib.inbuilt_lib.indexOf(`${t.name}`)===-1)if(n)i=n;else throw`[lib-name=${t.name},lib-src=${i}] not allowed or available in in-build mode. Need to use lazy-lib config.`;if(i.startsWith("./")||i.startsWith("../")){const b=await import(`${i}`);a.lib.l[`${c}`]={lib:b}}if(i.startsWith("http://")||i.startsWith("https://")){const b=await import(`${i}`);a.lib.l[`${c}`]={lib:b}}}}console.log(await a.lib.get_all({}))},get:async e=>{let r=null;const l=`${e.name}:${e.run_from}`;return a.lib.l.hasOwnProperty(`${l}`)==!1&&await a.lib.set({lib:[{renderer_src:e.name,hydrator_src:e.name,editor_src:e.name,name:e.name}],run_from:e.run_from,lazy_lib:e.lazy_lib}),r=a.lib.l[`${l}`],r},get_all:async e=>a.lib.l}};const m=async e=>{const r=await u();return await a.lib.set({lib:e.lib,run_from:"renderer",lazy_lib:e.lazy_lib}),{set:async(l,s)=>{console.log("--renderer [set]");let t={r:"",style:""};return await(async()=>{for(const o of l.data?.value?.l||l.data.l){const d=await(await(await(await a.lib.get({name:o.type,run_from:"renderer",lazy_lib:e.lazy_lib})).lib).index({f:{name:n=>r.f.name({id:o.id,name:n}),get_lib:async n=>await await a.lib.get({name:n.name,run_from:n.run_from,lazy_lib:e.lazy_lib})}})).set({data:{curr:o}},s);t.r+=d.r,t.style+=d.style}})(),t}}},x=async e=>{const r=await u();return await a.lib.set({lib:e.lib,run_from:"hydrator",lazy_lib:e.lazy_lib}),{set:async(l,s)=>{console.log("--hydrator [set]");let t={r:"",style:""};const c=async()=>{for(const o of l.data?.value?.l||l.data.l){const d=await(await(await(await a.lib.get({name:o.type,run_from:"hydrator",lazy_lib:e.lazy_lib})).lib).index({f:{name:n=>r.f.name({id:o.id,name:n}),get_lib:async n=>await await a.lib.get({name:n.name,run_from:n.run_from,lazy_lib:e.lazy_lib})}})).set({data:{curr:o}},s);t.style+=d.style}};return await g(()=>document.readyState==="complete"||typeof window<"u",50),await c(),t}}},h=async e=>(await u(),await a.lib.set({lib:e.lib,run_from:"editor",lazy_lib:e.lazy_lib}),{set:async(r,l)=>{console.log("--editor [set]");let s={data:{l:[{id:y().set(),type:"editor",data:{l:[]}}]}},t={r:"",style:""};const c=m,o=x,i=await c({lib:e.lib,lazy_lib:e.lazy_lib}),d=await o({lib:e.lib,lazy_lib:e.lazy_lib}),n=await i.set({data:s.data});return(async()=>{const b=await d.set({data:s.data},{change:f=>{l?.change(f)}});(f=>{const w=document.createElement("style");w.innerHTML=`${b.style}`,f.appendChild(w)})(document.head)})(),t.r=n.r,t.style=`
            ${n.style}
            `,t}});_.ce_editor=h,_.ce_hydrator=x,_.ce_renderer=m,Object.defineProperty(_,Symbol.toStringTag,{value:"Module"})}));
