(function(y,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(y=typeof globalThis<"u"?globalThis:y||self,u(y.content_engine_lib={}))})(this,(function(y){"use strict";const u=()=>({set:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const a=Math.random()*16|0;return(e=="x"?a:a&3|8).toString(16)})}),f=async()=>({f:{name:e=>`${e.name}${e.id}`}}),$=async()=>({set:async e=>{console.log("--theme");try{if(!e.el_id)throw new Error("[el_id] is required");const a=e.name,r=document.getElementById(e.el_id);if(!r)throw new Error("[el_id] is invalid");(c=>{const n=o=>{(s=>{const l=s.getAttribute("data-ce");if(!l)return;const t=JSON.parse(l).filter(_=>_?.k.startsWith("t-"));if(t.length!=0)for(const _ of t){const b=_.k,x=_.v.split(" ");if(b==`t-${a}-class`)for(const w of x)s.classList.add(w);else for(const w of x)s.classList.remove(w)}})(o)};for(const o of c.getElementsByTagName("*"))n(o);n(c)})(r)}catch(a){const r=`err: [theme] ${a}`;throw console.log(r),r}}});function z(e,a=1e3){let r={cnt:0};return new Promise(c=>{const n=()=>{console.log(`[setInterval] is running.. [count=${r.cnt}]`);try{e()&&(clearInterval(o),c())}catch{console.log(`warn: [wait_until] ignoring the exception in setInterval and will check again after [interval=${a}]`)}r.cnt+=1},o=setInterval(()=>{n()},a);n()})}console.log("content_engine_lib");let i={lib:{inbuilt_lib:[],l:{},set:async e=>{const a=e?.lib||[];for(const[r,c]of a.entries()){const n=c,o=`${n.name}:${e.run_from}`,s=`${e.run_from}_src`;let l=n[s];const d=`${e.run_from}_src`;let t=e?.lazy_lib?.[d]||null;if(t&&(t=t.replace("{*}",`${n.name}`)),console.log(`_lazy_src: ${t}`),console.log(`_src: ${l}`),i.lib.l.hasOwnProperty(`${o}`)==!1){if(/^[a-zA-Z0-9]/.test(l)&&l.includes("/")==!1&&i.lib.inbuilt_lib.indexOf(`${n.name}`)===-1)if(t)l=t;else throw`[lib-name=${n.name},lib-src=${l}] not allowed or available in in-build mode. Need to use lazy-lib config.`;if(l.startsWith("./")||l.startsWith("../")){const _=await import(`${l}`);i.lib.l[`${o}`]={lib:_}}if(l.startsWith("http://")||l.startsWith("https://")){const _=await import(`${l}`);i.lib.l[`${o}`]={lib:_}}}}console.log(await i.lib.get_all({}))},get:async e=>{let a=null;const r=`${e.name}:${e.run_from}`;return i.lib.l.hasOwnProperty(`${r}`)==!1&&await i.lib.set({lib:[{renderer_src:e.name,hydrator_src:e.name,editor_src:e.name,name:e.name}],run_from:e.run_from,lazy_lib:e.lazy_lib}),a=i.lib.l[`${r}`],a},get_all:async e=>i.lib.l}};const g=async e=>{const a=await f();return await i.lib.set({lib:e.lib,run_from:"renderer",lazy_lib:e.lazy_lib}),{set:async(r,c)=>{console.log("--renderer [set]");let n={r:"",style:""};return await(async()=>{for(const s of r.data?.value?.l||r.data.l){const d=await(await(await(await i.lib.get({name:s.type,run_from:"renderer",lazy_lib:e.lazy_lib})).lib).index({f:{name:t=>a.f.name({id:s.id,name:t}),get_lib:async t=>await await i.lib.get({name:t.name,run_from:t.run_from,lazy_lib:e.lazy_lib})}})).set({data:{curr:s}},c);n.r+=d.r,n.style+=d.style}})(),n}}},h=async e=>{const a=await f();return await i.lib.set({lib:e.lib,run_from:"hydrator",lazy_lib:e.lazy_lib}),{set:async(r,c)=>{console.log("--hydrator [set]");let n={r:"",style:""};const o=async()=>{for(const s of r.data?.value?.l||r.data.l){const d=await(await(await(await i.lib.get({name:s.type,run_from:"hydrator",lazy_lib:e.lazy_lib})).lib).index({f:{name:t=>a.f.name({id:s.id,name:t}),get_lib:async t=>await await i.lib.get({name:t.name,run_from:t.run_from,lazy_lib:e.lazy_lib}),set_theme:async t=>await(await $()).set(t)}})).set({data:{curr:s}},c);n.style+=d.style}};return await z(()=>document.readyState==="complete"||typeof window<"u",50),await o(),n}}},p=async e=>(await f(),await i.lib.set({lib:e.lib,run_from:"editor",lazy_lib:e.lazy_lib}),{set:async(a,r)=>{console.log("--editor [set]");let c={data:{l:[{id:u().set(),type:"editor",data:{l:[]}}]}},n={r:"",style:""};const o=g,s=h,l=await o({lib:e.lib,lazy_lib:e.lazy_lib}),d=await s({lib:e.lib,lazy_lib:e.lazy_lib}),t=await l.set({data:c.data});return(async()=>{const _=await d.set({data:c.data},{change:b=>{r?.change(b)}});(b=>{const m=document.createElement("style");m.innerHTML=`${_.style}`,b.appendChild(m)})(document.head)})(),n.r=t.r,n.style=`
            ${t.style}
            `,n}});y.ce_editor=p,y.ce_hydrator=h,y.ce_renderer=g,Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})}));
