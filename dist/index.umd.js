(function(d,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(d=typeof globalThis<"u"?globalThis:d||self,u(d.content_engine_lib={}))})(this,(function(d){"use strict";const u=()=>({set:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const a=Math.random()*16|0;return(t=="x"?a:a&3|8).toString(16)})}),f=async()=>({f:{name:t=>`${t.name}${t.id}`}}),h=async()=>({set:async t=>{console.log("--theme");try{if(!t.el_id)throw new Error("[el_id] is required");const a=t.name,l=document.getElementById(t.el_id);if(!l)throw new Error("[el_id] is invalid");(_=>{const n=c=>{(s=>{const r=s.getAttribute("data-ce");if(!r)return;const o=JSON.parse(r).filter(e=>e?.k.startsWith("t-"));if(o.length!=0)for(const e of o){const b=e.k,$=e.v.split(" ");if(b==`t-${a}-class`)for(const w of $)s.classList.add(w);else for(const w of $)s.classList.remove(w)}})(c)};for(const c of _.getElementsByTagName("*"))n(c);n(_)})(l)}catch(a){const l=`err: [theme] ${a}`;throw console.log(l),l}}});function z(t,a=1e3){let l={cnt:0};return new Promise(_=>{const n=()=>{console.log(`[setInterval] is running.. [count=${l.cnt}]`);try{t()&&(clearInterval(c),_())}catch{console.log(`warn: [wait_until] ignoring the exception in setInterval and will check again after [interval=${a}]`)}l.cnt+=1},c=setInterval(()=>{n()},a);n()})}console.log("content_engine_lib");let i={lib:{inbuilt_lib:[],l:{},set:async t=>{const a=t?.lib||[];for(const[l,_]of a.entries()){const n=_,c=`${n.name}:${t.run_from}`,s=`${t.run_from}_src`;let r=n[s];const y=`${t.run_from}_src`;let o=t?.lazy_lib?.[y]||null;if(o&&(o=o.replace("{*}",`${n.name}`)),console.log(`_lazy_src: ${o}`),console.log(`_src: ${r}`),i.lib.l.hasOwnProperty(`${c}`)==!1){if(/^[a-zA-Z0-9]/.test(r)&&r.includes("/")==!1&&i.lib.inbuilt_lib.indexOf(`${n.name}`)===-1)if(o)r=o;else throw`[lib-name=${n.name},lib-src=${r}] not allowed or available in in-build mode. Need to use lazy-lib config.`;if(r.startsWith("./")||r.startsWith("../")){const e=await import(`${r}`);i.lib.l[`${c}`]={lib:e,src:r}}if(r.startsWith("http://")||r.startsWith("https://")){const e=await import(`${r}`);i.lib.l[`${c}`]={lib:e,src:r}}}}console.log(await i.lib.get_all({}))},get:async t=>{let a=null;const l=`${t.name}:${t.run_from}`;return i.lib.l.hasOwnProperty(`${l}`)==!1&&await i.lib.set({lib:[{renderer_src:t.name,hydrator_src:t.name,editor_src:t.name,name:t.name}],run_from:t.run_from,lazy_lib:t.lazy_lib}),a=i.lib.l[`${l}`],a},get_all:async t=>i.lib.l},path:{set:t=>{let a="";const l=t.src.split("/");for(const[_,n]of l.entries()){let c=_==0?"":"/";if(a+=`${c}${n}`,n==t.type)return`${a}${t.name}`}return`${a}${t.name}`}}};const g=async t=>{const a=await f();return await i.lib.set({lib:t.lib,run_from:"renderer",lazy_lib:t.lazy_lib}),{set:async(l,_)=>{console.log("--renderer [set]");let n={r:"",style:""};return await(async()=>{for(const s of l.data?.value?.l||l.data.l){const r=await await i.lib.get({name:s.type,run_from:"renderer",lazy_lib:t.lazy_lib}),o=await(await r.lib.index({f:{name:e=>a.f.name({id:s.id,name:e}),get_lib:async e=>await await i.lib.get({name:e.name,run_from:e.run_from,lazy_lib:t.lazy_lib}),set_theme:async e=>await(await h()).set(e),path:e=>i.path.set({src:r.src,type:s.type,name:e})}})).set({data:{curr:s}},_);n.r+=o.r,n.style+=o.style}})(),n}}},x=async t=>{const a=await f();return await i.lib.set({lib:t.lib,run_from:"hydrator",lazy_lib:t.lazy_lib}),{set:async(l,_)=>{console.log("--hydrator [set]");let n={r:"",style:""};const c=async()=>{for(const s of l.data?.value?.l||l.data.l){const r=await await i.lib.get({name:s.type,run_from:"hydrator",lazy_lib:t.lazy_lib}),o=await(await r.lib.index({f:{name:e=>a.f.name({id:s.id,name:e}),get_lib:async e=>await await i.lib.get({name:e.name,run_from:e.run_from,lazy_lib:t.lazy_lib}),set_theme:async e=>await(await h()).set(e),path:e=>i.path.set({src:r.src,type:s.type,name:e})}})).set({data:{curr:s}},_);n.style+=o.style}};return await z(()=>document.readyState==="complete"||typeof window<"u",50),await c(),n}}},p=async t=>(await f(),await i.lib.set({lib:t.lib,run_from:"editor",lazy_lib:t.lazy_lib}),{set:async(a,l)=>{console.log("--editor [set]");let _={data:{l:[{id:u().set(),type:"editor",data:{l:[]}}]}},n={r:"",style:""};const c=g,s=x,r=await c({lib:t.lib,lazy_lib:t.lazy_lib}),y=await s({lib:t.lib,lazy_lib:t.lazy_lib}),o=await r.set({data:_.data});return(async()=>{const e=await y.set({data:_.data},{change:b=>{l?.change(b)}});(b=>{const m=document.createElement("style");m.innerHTML=`${e.style}`,b.appendChild(m)})(document.head)})(),n.r=o.r,n.style=`
            ${o.style}
            `,n}});d.ce_editor=p,d.ce_hydrator=x,d.ce_renderer=g,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})}));
