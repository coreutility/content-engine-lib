(function(d,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(d=typeof globalThis<"u"?globalThis:d||self,u(d.content_engine_lib={}))})(this,(function(d){"use strict";const u=()=>({set:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const a=Math.random()*16|0;return(e=="x"?a:a&3|8).toString(16)})}),b=async()=>({f:{name:e=>`${e.name}${e.id}`}}),h=async()=>({set:async e=>{console.log("--theme");try{if(!e.el_id)throw new Error("[el_id] is required");const a=e.name,n=document.getElementById(e.el_id);if(!n)throw new Error("[el_id] is invalid");(o=>{const r=s=>{(i=>{const l=i.getAttribute("data-ce");if(!l)return;const _=JSON.parse(l).filter(t=>t?.k.startsWith("t-"));if(_.length!=0)for(const t of _){const f=t.k,g=t.v.split(" ");if(f==`t-${a}-class`)for(const w of g)i.classList.add(w);else for(const w of g)i.classList.remove(w)}})(s)};for(const s of o.getElementsByTagName("*"))r(s);r(o)})(n)}catch(a){const n=`err: [theme] ${a}`;throw console.log(n),n}}});function p(e,a=1e3){let n={cnt:0};return new Promise(o=>{const r=()=>{console.log(`[setInterval] is running.. [count=${n.cnt}]`);try{e()&&(clearInterval(s),o())}catch{console.log(`warn: [wait_until] ignoring the exception in setInterval and will check again after [interval=${a}]`)}n.cnt+=1},s=setInterval(()=>{r()},a);r()})}console.log("content_engine_lib");let c={lib:{inbuilt_lib:[],l:{},set:async e=>{const a=e?.lib||[];for(const[n,o]of a.entries()){const r=o,s=`${r.name}:${e.run_from}`,i=`${e.run_from}_src`;let l=r[i];const y=`${e.run_from}_src`;let _=e?.lazy_lib?.[y]||null;if(_&&(_=_.replace("{*}",`${r.name}`)),console.log(`_lazy_src: ${_}`),console.log(`_src: ${l}`),c.lib.l.hasOwnProperty(`${s}`)==!1){if(/^[a-zA-Z0-9]/.test(l)&&l.includes("/")==!1&&c.lib.inbuilt_lib.indexOf(`${r.name}`)===-1)if(_)l=_;else throw`[lib-name=${r.name},lib-src=${l}] not allowed or available in in-build mode. Need to use lazy-lib config.`;if(l.startsWith("./")||l.startsWith("../")){const t=await import(`${l}`);c.lib.l[`${s}`]={lib:t,src:l}}if(l.startsWith("http://")||l.startsWith("https://")){const t=await import(`${l}`);c.lib.l[`${s}`]={lib:t,src:l}}}}console.log(await c.lib.get_all({}))},get:async e=>{let a=null;const n=`${e.name}:${e.run_from}`;return c.lib.l.hasOwnProperty(`${n}`)==!1&&await c.lib.set({lib:[{renderer_src:e.name,hydrator_src:e.name,editor_src:e.name,name:e.name}],run_from:e.run_from,lazy_lib:e.lazy_lib}),a=c.lib.l[`${n}`],a},get_all:async e=>c.lib.l},path:{set:e=>{let a="",n="";const o=e.src.split("/");if(o.indexOf("://localhost")!==-1||o.indexOf("://127.0.0.1")!==-1||(n="/dist"),o.indexOf(e.type)!==-1)for(const[r,s]of o.entries()){let i=r==0?"":"/";if(a+=`${i}${s}`,s==e.type)return`${a}${n}${e.name}`}else for(const[r,s]of o.entries()){let i=r==0?"":"/";if(a+=`${i}${s}`,s=="src")return`${a}${n}${e.name}`}return`${a}${n}${e.name}`}}};const $=async e=>{const a=await b();return await c.lib.set({lib:e.lib,run_from:"renderer",lazy_lib:e.lazy_lib}),{set:async(n,o)=>{console.log("--renderer [set]");let r={r:"",style:""};return await(async()=>{for(const i of n.data?.value?.l||n.data.l){const l=await await c.lib.get({name:i.type,run_from:"renderer",lazy_lib:e.lazy_lib}),_=await(await l.lib.index({f:{name:t=>a.f.name({id:i.id,name:t}),get_lib:async t=>await await c.lib.get({name:t.name,run_from:t.run_from,lazy_lib:e.lazy_lib}),set_theme:async t=>await(await h()).set(t),path:t=>c.path.set({src:l.src,type:i.type,name:t})}})).set({data:{curr:i}},o);r.r+=_.r,r.style+=_.style}})(),r}}},x=async e=>{const a=await b();return await c.lib.set({lib:e.lib,run_from:"hydrator",lazy_lib:e.lazy_lib}),{set:async(n,o)=>{console.log("--hydrator [set]");let r={r:"",style:""};const s=async()=>{for(const i of n.data?.value?.l||n.data.l){const l=await await c.lib.get({name:i.type,run_from:"hydrator",lazy_lib:e.lazy_lib}),_=await(await l.lib.index({f:{name:t=>a.f.name({id:i.id,name:t}),get_lib:async t=>await await c.lib.get({name:t.name,run_from:t.run_from,lazy_lib:e.lazy_lib}),set_theme:async t=>await(await h()).set(t),path:t=>c.path.set({src:l.src,type:i.type,name:t})}})).set({data:{curr:i}},o);r.style+=_.style}};return await p(()=>document.readyState==="complete"||typeof window<"u",50),await s(),r}}},z=async e=>(await b(),await c.lib.set({lib:e.lib,run_from:"editor",lazy_lib:e.lazy_lib}),{set:async(a,n)=>{console.log("--editor [set]");let o={data:{l:[{id:u().set(),type:"editor",data:{l:[]}}]}},r={r:"",style:""};const s=$,i=x,l=await s({lib:e.lib,lazy_lib:e.lazy_lib}),y=await i({lib:e.lib,lazy_lib:e.lazy_lib}),_=await l.set({data:o.data});return(async()=>{const t=await y.set({data:o.data},{change:f=>{n?.change(f)}});(f=>{const m=document.createElement("style");m.innerHTML=`${t.style}`,f.appendChild(m)})(document.head)})(),r.r=_.r,r.style=`
            ${_.style}
            `,r}});d.ce_editor=z,d.ce_hydrator=x,d.ce_renderer=$,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})}));
